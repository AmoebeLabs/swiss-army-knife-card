export default class Templates{static replaceVariables3(e,t){if(!e&&!t.template.defaults)return t[t.template.type];let a=e?.slice(0)??[],i=(t.template.defaults&&(a=a.concat(t.template.defaults)),JSON.stringify(t[t.template.type]));return a.forEach(e=>{var t,a,s=Object.keys(e)[0],e=Object.values(e)[0];"number"!=typeof e&&"boolean"!=typeof e||(a=new RegExp(`"\\[\\[${s}\\]\\]"`,"gm"),i=i.replace(a,e)),i="object"==typeof e?(a=new RegExp(`"\\[\\[${s}\\]\\]"`,"gm"),t=JSON.stringify(e),i.replace(a,t)):(a=new RegExp(`\\[\\[${s}\\]\\]`,"gm"),i.replace(a,e))}),JSON.parse(i)}static getJsTemplateOrValueConfig(t,a){var e;return a&&(["number","boolean","bigint","symbol"].includes(typeof a)?a:"object"==typeof a?(Object.keys(a).forEach(e=>{a[e]=Templates.getJsTemplateOrValueConfig(t,a[e])}),a):"[[[["===(e=a.trim()).substring(0,4)&&"]]]]"===e.slice(-4)?Templates.evaluateJsTemplateConfig(t,e.slice(4,-4)):a)}static evaluateJsTemplateConfig(e,t){try{return new Function("tool_config","'use strict'; "+t).call(this,e)}catch(e){throw e.name="Sak-evaluateJsTemplateConfig-Error",e}}static evaluateJsTemplate(e,t,a){try{return new Function("state","states","entity","user","hass","tool_config","entity_config","'use strict'; "+a).call(this,t,e._card._hass.states,e.config.hasOwnProperty("entity_index")?e._card.entities[e.config.entity_index]:void 0,e._card._hass.user,e._card._hass,e.config,e.config.hasOwnProperty("entity_index")?e._card.config.entities[e.config.entity_index]:void 0)}catch(e){throw e.name="Sak-evaluateJsTemplate-Error",e}}static getJsTemplateOrValue(t,a,s){var e;return s&&(["number","boolean","bigint","symbol"].includes(typeof s)?s:"object"==typeof s?(Object.keys(s).forEach(e=>{s[e]=Templates.getJsTemplateOrValue(t,a,s[e])}),s):"[[["===(e=s.trim()).substring(0,3)&&"]]]"===e.slice(-3)?Templates.evaluateJsTemplate(t,a,e.slice(3,-3)):s)}}